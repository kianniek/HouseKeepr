# Android Google Sign-in: Reproduction & Fix

This short guide documents the steps taken to fix Google Sign-in failing with
``ApiException: 10`` (DEVELOPER_ERROR) on Android and how to reproduce the fix.

Why the error happens
- ApiException: 10 typically means the Google OAuth client configuration
  doesn't match the running app. The most common mismatch is the Android
  package name + SHA-1 (or SHA-256) fingerprint not being registered in
  the Firebase project settings / Google Cloud OAuth credentials.

Quick reproduction steps
1. Attempt to sign in with Google on an Android device/emulator.
2. If sign-in silently fails or you see `PlatformException(sign_in_failed, ApiException: 10, ...)` in logs, proceed to the fix below.

Fix
1. Obtain the app's SHA-1 and SHA-256 fingerprints.
   - Preferred: From the project's Android Gradle signing report:

```powershell
# from project root
cd android
./gradlew signingReport
# on Windows PowerShell you can run: .\gradlew signingReport
```

   - Alternatively, use `keytool` against your keystore if you have it available.

2. In the Firebase Console (Project settings → General) open the Android app entry
   for your package (e.g., `com.example.housekeepr`) and add the SHA-1 and
   SHA-256 fingerprints under "SHA certificate fingerprints".

3. Enable Google sign-in: Firebase Console → Authentication → Sign-in method → Enable "Google".

4. Download the updated `google-services.json` from the Firebase Console and overwrite
   `android/app/google-services.json` in the project.

5. Rebuild and reinstall the app (ensures the updated config is bundled):

```powershell
# project root (Flutter workspace)
flutter clean
flutter pub get
flutter run -d <device-id>
```

Verification
- On successful sign-in the app will return a Firebase `User` and you should see
  the user listed in Firebase Console → Authentication → Users.
- Inspect logs for the GoogleSignIn flow (account selection and returned tokens).

Notes
- Do NOT log idToken/accessToken in production logs.
- For release builds, add the release keystore's SHA-1 to Firebase as well
  to avoid the same error after signing.
- If you're using CI or an alternative keystore, register those fingerprints too.

If the issue persists after following these steps, verify:
- The Android `applicationId` in `android/app/build.gradle` matches the package name registered in Firebase.
- Google Cloud OAuth credentials list an Android client with the same package name and SHA-1.
- Changes may take a few minutes to propagate.

---
Generated by the project maintenance script. Update this doc if you change the
signing or CI process.
